<div class="container">
    <h2>Submit Candidature</h2>
    <div *ngIf="user" class="user-info">
      <p><strong>Name:</strong> {{ user.fullName }}</p>
      <p><strong>Email:</strong> {{ user.email }}</p>
      <p><strong>Phone:</strong> {{ user.phoneNumber }}</p>
    </div>
    <form (ngSubmit)="submit()" #candidatureForm="ngForm">
      <div class="form-group">
        <label for="offreId">Job Offer</label>
        <select id="offreId" [(ngModel)]="candidature.offreId" name="offreId" required>
          <option value="" disabled>Select an offer</option>
          <option *ngFor="let offre of offres" [value]="offre.idOffreEmploi">{{ offre.titre }}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="messageMotivation">Motivation Message</label>
        <textarea id="messageMotivation" [(ngModel)]="candidature.messageMotivation" name="messageMotivation" required></textarea>
      </div>
      <div class="form-group">
        <label for="cv">CV URL</label>
        <input id="cv" [(ngModel)]="candidature.cv" name="cv" required />
      </div>
      <div class="form-group">
        <label for="linkedIn">LinkedIn URL</label>
        <input id="linkedIn" [(ngModel)]="candidature.linkedIn" name="linkedIn" required />
      </div>
      <div class="form-group">
        <label for="github">GitHub URL</label>
        <input id="github" [(ngModel)]="candidature.github" name="github" required />
      </div>
      <div class="form-group">
        <label for="portfolio">Portfolio URL</label>
        <input id="portfolio" [(ngModel)]="candidature.portfolio" name="portfolio" required />
      </div>
  
      <h3>Experiences</h3>
      <div *ngFor="let experience of candidature.experiences; let i=index" class="experience">
        <div class="form-group">
          <label for="poste-{{i}}">Position</label>
          <input id="poste-{{i}}" [(ngModel)]="experience.poste" name="poste-{{i}}" required />
        </div>
        <div class="form-group">
          <label for="nomEntreprise-{{i}}">Company</label>
          <input id="nomEntreprise-{{i}}" [(ngModel)]="experience.nomEntreprise" name="nomEntreprise-{{i}}" required />
        </div>
        <div class="form-group">
          <label for="description-{{i}}">Description</label>
          <textarea id="description-{{i}}" [(ngModel)]="experience.description" name="description-{{i}}" required></textarea>
        </div>
        <div class="form-group">
          <label for="competenceAcquise-{{i}}">Skills Acquired</label>
          <input id="competenceAcquise-{{i}}" [(ngModel)]="experience.competenceAcquise" name="competenceAcquise-{{i}}" required />
        </div>
        <div class="form-group">
          <label for="dateDebut-{{i}}">Start Date</label>
          <input id="dateDebut-{{i}}" [(ngModel)]="experience.dateDebut" name="dateDebut-{{i}}" type="date" required />
        </div>
        <div class="form-group">
          <label for="dateFin-{{i}}">End Date</label>
          <input id="dateFin-{{i}}" [(ngModel)]="experience.dateFin" name="dateFin-{{i}}" type="date" />
        </div>
  
        <h4>Certificates</h4>
        <div *ngFor="let certificat of experience.certificats; let j=index">
          <div class="form-group">
            <label for="cert-nom-{{i}}-{{j}}">Certificate Name</label>
            <input id="cert-nom-{{i}}-{{j}}" [(ngModel)]="certificat.nom" name="cert-nom-{{i}}-{{j}}" required />
          </div>
          <div class="form-group">
            <label for="cert-date-{{i}}-{{j}}">Obtained Date</label>
            <input id="cert-date-{{i}}-{{j}}" [(ngModel)]="certificat.dateObtention" name="cert-date-{{i}}-{{j}}" type="date" required />
          </div>
          <div class="form-group">
            <label for="cert-org-{{i}}-{{j}}">Organization</label>
            <input id="cert-org-{{i}}-{{j}}" [(ngModel)]="certificat.organisme" name="cert-org-{{i}}-{{j}}" required />
          </div>
          <div class="form-group">
            <label for="cert-desc-{{i}}-{{j}}">Description</label>
            <textarea id="cert-desc-{{i}}-{{j}}" [(ngModel)]="certificat.description" name="cert-desc-{{i}}-{{j}}" required></textarea>
          </div>
          <div class="form-group">
            <label for="cert-url-{{i}}-{{j}}">Document URL</label>
            <input id="cert-url-{{i}}-{{j}}" [(ngModel)]="certificat.urlDocument" name="cert-url-{{i}}-{{j}}" required />
          </div>
        </div>
        <button type="button" (click)="addCertificat(i)">Add Certificate</button>
      </div>
      <button type="button" (click)="addExperience()">Add Experience</button>
  
      <h3>Competences</h3>
      <div *ngFor="let competence of candidature.competences; let i=index">
        <div class="form-group">
          <label for="competenceId-{{i}}">Competence ID</label>
          <input id="competenceId-{{i}}" [(ngModel)]="competence.competenceId" name="competenceId-{{i}}" required />
        </div>
        <div class="form-group">
          <label for="niveauPossede-{{i}}">Level</label>
          <select id="niveauPossede-{{i}}" [(ngModel)]="competence.niveauPossede" name="niveauPossede-{{i}}" required>
            <option value="Débutant">Débutant</option>
            <option value="Intermédiaire">Intermédiaire</option>
            <option value="Avancé">Avancé</option>
          </select>
        </div>
      </div>
      <button type="button" (click)="addCompetence()">Add Competence</button>
  
      <button type="submit" [disabled]="!candidatureForm.valid">Submit</button>
    </form>
    <div *ngIf="successMessage" class="success">{{ successMessage }}</div>
    <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
  </div>